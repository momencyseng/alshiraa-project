{% extends "base.html" %}

{% block content %}
<section class="section">
    <div class="container">
        <h1 class="heading-lg text-center" style="margin-bottom: 2rem;">
            <span class="lang-en">Manage Orders</span>
            <span class="lang-ar">إدارة الطلبات</span>
        </h1>

        <div style="overflow-x: auto;">
            <table
                style="width: 100%; border-collapse: collapse; min-width: 800px; background: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 8px;">
                <thead>
                    <tr style="background: #f8f9fa; border-bottom: 2px solid #ddd;">
                        <th style="padding: 1rem; text-align: left;">#</th>
                        <th style="padding: 1rem; text-align: left;">Customer</th>
                        <th style="padding: 1rem; text-align: left;">Phone</th>
                        <th style="padding: 1rem; text-align: left;">Date</th>
                        <th style="padding: 1rem; text-align: left;">Total</th>
                        <th style="padding: 1rem; text-align: left;">Status</th>
                        <th style="padding: 1rem; text-align: left;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 1rem;">{{ order.id }}</td>
                        <td style="padding: 1rem;">
                            {{ order.customer_name }}<br>
                            <small class="text-muted">{{ order.address }}</small>
                        </td>
                        <td style="padding: 1rem;">{{ order.phone_number }}</td>
                        <td style="padding: 1rem;">{{ order.created_at.strftime('%Y-%m-%d') }}</td>
                        <td style="padding: 1rem;">{{ order.total_price }} IQD</td>
                        <td style="padding: 1rem;">
                            <span class="badge" style="padding: 0.3rem 0.6rem; border-radius: 4px; background: 
                                {% if order.status == 'New' %}#007bff; color: white;
                                {% elif order.status == 'Completed' %}#28a745; color: white;
                                {% else %}#6c757d; color: white;{% endif %}">
                                {{ order.status }}
                            </span>
                        </td>
                        <td style="padding: 1rem;">
                            <form action="{{ url_for('update_order_status', order_id=order.id) }}" method="POST"
                                style="display: flex; gap: 0.5rem;">
                                <select name="status"
                                    style="padding: 0.3rem; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="New" {% if order.status=='New' %}selected{% endif %}>New</option>
                                    <option value="Processing" {% if order.status=='Processing' %}selected{% endif %}>
                                        Processing</option>
                                    <option value="Completed" {% if order.status=='Completed' %}selected{% endif %}>
                                        Completed</option>
                                    <option value="Cancelled" {% if order.status=='Cancelled' %}selected{% endif %}>
                                        Cancelled</option>
                                </select>
                                <button type="submit" class="btn secondary-btn"
                                    style="padding: 0.3rem 0.6rem; font-size: 0.8rem;">Update</button>
                            </form>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="7" style="padding: 2rem; text-align: center;">No orders found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div style="margin-top: 2rem; text-align: center;">
            <a href="{{ url_for('dashboard') }}" class="btn">Back to Dashboard</a>
        </div>
    </div>
</section>
{% endblock %}